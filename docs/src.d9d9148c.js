parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"jftt":[function(require,module,exports) {
var define;
var e;!function(t,s){"object"==typeof exports&&"object"==typeof module?module.exports=s():"function"==typeof e&&e.amd?e([],s):"object"==typeof exports?exports.Ludic=s():t.Ludic=s()}(window,function(){return function(e){var t={};function s(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,s),n.l=!0,n.exports}return s.m=e,s.c=t,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(r,n,function(t){return e[t]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s="./src/main.ts")}({"./src/asset/asset.ts":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t,s,r){this.name=e,this.url=t,this.type=s,this.options=r||{}}load(){}onload(e,t){return()=>{e(this)}}onAssetResolve(e){}onAssetReject(e){}destroy(){this.name=null,this.url=null,this.type=null,this.options=null,this.data=null}}},"./src/asset/assetLoader.ts":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.t={}},"./src/asset/assetManager.ts":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s("./src/asset/imageAssetLoader.ts"),n=s("./src/asset/audioAssetLoader.ts");class i{constructor(){this.assets={},this.loadQueue=[],this.promiseQueue=[],this.loaders={},this.addLoader("image",r.default),this.addLoader("audio",n.default)}loadResource(e,t,s,r,n){let i=null;if(!this.assets[e]||n){let n=this.NewAsset(e,t,s,r);null!=n&&(this.loadQueue.push(n),this.loading=!0,i=n.promise.then(this.onAssetResolve.bind(this),this.onAssetReject.bind(this)))}return i}getAsset(e){return this.assets[e]}getImage(e){let t=this.getAsset(e);switch(t.type){case"image":case"rubeImage":return t.data;default:return null}}getData(e){return this.getAsset(e).data}onAssetResolve(e){return this.assets[e.name]=e,e.onAssetResolve(this),e}onAssetReject(){return console.log("rejected: ",arguments),Promise.reject({reason:"onAssetReject"})}isLoading(){return this.loading}update(){if(0==this.loadQueue.length)this.finalPromise||(this.finalPromise=Promise.all(this.promiseQueue).then(()=>{this.finalPromise&&(this.assetsLoaded.apply(this,arguments),this.promiseQueue=[])}));else{this.finalPromise=null;let e=this.loadQueue.shift();this.promiseQueue.push(e.promise),e.load()}}assetsLoaded(){this.onAssetsLoadedCallback&&this.onAssetsLoadedCallback(this),this.loading=!1}setOnAssetsLoadedCallback(e){this.onAssetsLoadedCallback=e}NewAsset(e,t,s,r){s=s||"image";let n=this.loaders[s];return n?n.load(e,t,s,r):null}destroyAsset(e){delete this.assets[e.name],e.destroy()}addLoader(e,t){"string"==typeof e&&(e=[e]),e.forEach(e=>{this.loaders[e]=t})}}t.AssetManager=i,t.default=new i},"./src/asset/audioAsset.ts":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s("./src/asset/asset.ts");t.default=class extends r.default{constructor(e,t,s,r){super(e,t,s||"audio",r),this.context=new AudioContext,this.promise=new Promise((e,t)=>{this.request=new XMLHttpRequest,this.request.open("GET",this.url,!0),this.request.responseType="arraybuffer",this.request.onreadystatechange=this.onload(e,t)})}load(){this.request.send()}onload(e,t){return()=>{this.request.readyState==XMLHttpRequest.DONE&&(200==this.request.status?this.context.decodeAudioData(this.request.response,s=>{if(!s)return console.error("AudioAsset: Error decoding file data: "+this.url),void t(this);this.data=s,e(this)},e=>{console.error("AudioAsset: decodeAudioData error",e),t(this)}):console.error("AudioAsset: Request failure: ",this.request.status,this.request.statusText,this.request))}}}},"./src/asset/audioAssetLoader.ts":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s("./src/asset/audioAsset.ts");t.default=new class{load(e,t,s,n){return new r.default(e,t,s,n)}}},"./src/asset/imageAsset.ts":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s("./src/asset/asset.ts");t.default=class extends r.default{constructor(e,t,s,r){super(e,t,s||"image",r),this.data=new Image,this.promise=new Promise((e,t)=>{this.data.onload=this.onload(e,t)})}load(){this.data.src=this.url}}},"./src/asset/imageAssetLoader.ts":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s("./src/asset/imageAsset.ts");t.default=new class{load(e,t,s,n){return new r.default(e,t,s,n)}}},"./src/core/app.ts":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s("./src/core/canvas.ts"),n=s("./src/input/manager.ts");class i{constructor(e){if(i.$instance)return i.$instance;const{el:t,plugins:s=[]}=e;i.$instance=this,i.canvas=new r.default(t),s.forEach(e=>this.install(e)),this.requestAnimationFrame=(()=>window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame)().bind(window),this.animate=this.animate.bind(this)}start(){i.$running=!0,this.lastRunTime=performance.now(),this.requestAnimationFrame(this.animate)}animate(e){this.requestAnimationFrame(this.animate);let t=performance.now(),s=t-this.lastRunTime;this.update(e,s),this.lastRunTime=t}update(e,t){i.input.update(e,t)}install(e){e(i)}}i.input=new n.default,i.$running=!1,t.Ludic=i,t.default=i},"./src/core/camera.ts":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s("./src/core/canvas.ts"),n=s("./src/utils/vector2.ts"),i={inverseY:!0,inverseX:!1,x:0,y:0,pixelsToMeters:32,width:300,height:150};class o{constructor(...e){this.viewCenterPixel=new n.default(0,0),this.singleWorldPoint=new n.default(0,0),this.singlePixelPoint=new n.default(0,0),this.offset=new n.default(0,0),this.futurePos=new n.default(0,0);let t=Object.assign({},i);if(1===e.length){const s=e[0];"object"==typeof s?s instanceof r.default?(t.width=s.element.width,t.height=s.element.height):t=Object.assign(t,s):"number"==typeof s?t.pixelsToMeters=s:console.warn(`Camera::Unknown single argument '${typeof s}'.`,e)}else if(2===e.length){let[s,r]=e;t.width=s,t.height=r}else if(4===e.length){let[s,r,n,i]=e;t.x=s,t.y=r,t.width=n,t.height=i}else 0===e.length?console.warn("Camera::Initialized without any args.",e):0!==e.length&&console.warn("Camera::Unknown args.",e);this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this.inverseX=t.inverseX,this.inverseY=t.inverseY,this.pixelsToMeters=t.pixelsToMeters,this.updateEnvironmentVariables()}update(e){this.setTransform(e)}drawAxes(e){e.save(),e.lineWidth=1/this.pixelsToMeters,e.strokeStyle="rgb(192,0,0)",e.beginPath(),e.moveTo(0,0),e.lineTo(1,0),e.stroke(),e.strokeStyle="rgb(0,192,0)",e.beginPath(),e.moveTo(0,0),e.lineTo(0,1),e.stroke(),e.restore()}drawBounds(e,t="red"){let s=this.getViewportBounds();e.save(),e.strokeStyle=t,e.lineWidth=1/this.pixelsToMeters,e.strokeRect(s.x,s.y,s.w-s.x,s.h-s.y),e.restore()}getWorldPointFromPixelPoint(e){return this.singleWorldPoint.x=this._getWorldPointFromPixelPoint_x(e.x),this.singleWorldPoint.y=this._getWorldPointFromPixelPoint_y(e.y),this.singleWorldPoint}_getWorldPointFromPixelPoint_x(e){return(this.inverseX?this.offset.x-e:e-this.offset.x)/this.pixelsToMeters}_getWorldPointFromPixelPoint_y(e){return(this.inverseY?e-(this.height-this.offset.y):this.height-this.offset.y-e)/this.pixelsToMeters}getPixelPointFromWorldPoint(e){return this.singlePixelPoint.x=this._getPixelPointFromWorldPoint_x(e.x),this.singlePixelPoint.y=this._getPixelPointFromWorldPoint_y(e.y),this.singlePixelPoint}_getPixelPointFromWorldPoint_x(e){return this.inverseX?this.offset.x-e*this.pixelsToMeters:e*this.pixelsToMeters+this.offset.x}_getPixelPointFromWorldPoint_y(e){return this.inverseY?e*this.pixelsToMeters+(this.height-this.offset.y):this.height-this.offset.y-e*this.pixelsToMeters}setViewCenterWorld(e,t,s=0){let r=this.getViewCenterWorld(),i=new n.default;i.x=e.get_x()-r.x,i.y=e.get_y()-r.y,this.moveCenterBy(i,t,s)}centerWorldToCamera(){this.setOffset(this.viewCenterPixel)}centerWorldToTopLeft(){this.setViewCenterWorld(new n.default,!0)}getViewCenterWorld(){return this.getWorldPointFromPixelPoint(this.viewCenterPixel)}moveCenterBy(e,t,s){s=s||(t?1:.25),this.offset.x-=a(s*e.x*this.pixelsToMeters,0),this.offset.y+=a(s*e.y*this.pixelsToMeters,0)}updateEnvironmentVariables(){this.viewCenterPixel.set_x(this.width/2),this.viewCenterPixel.set_y(this.height/2)}getViewCenterPixel(){return this.viewCenterPixel}getViewportBounds(){return{x:this._getWorldPointFromPixelPoint_x(this.x),y:this._getWorldPointFromPixelPoint_y(this.y),w:this._getWorldPointFromPixelPoint_x(this.width),h:this._getWorldPointFromPixelPoint_y(this.height)}}setCameraBounds(...e){if(1===e.length){const{x:t=this.x,y:s=this.y,width:r=this.width,height:n=this.height}=e[0];this.x=t,this.y=s,this.width=r,this.height=n}else if(4===e.length){const[t=this.x,s=this.y,r=this.width,n=this.height]=e;this.x=t,this.y=s,this.width=r,this.height=n}return{x:this.x,y:this.y,width:this.width,height:this.height}}getOffset(){return this.offset}getOffsetX(){return this.offset.x}getOffsetY(){return this.offset.y}setOffset(...e){1===e.length?(this.offset.x=e[0].x||0,this.offset.y=e[0].y||0):2===e.length&&(this.offset.x=e[0],this.offset.y=e[1])}setTransform(e){e.translate(this.getOffsetX(),this.getOffsetY()),e.scale(this.inverseX?-this.pixelsToMeters:this.pixelsToMeters,this.inverseY?-this.pixelsToMeters:this.pixelsToMeters)}resetTransform(e){e.scale(this.inverseX?-1/this.pixelsToMeters:1/this.pixelsToMeters,this.inverseY?-1/this.pixelsToMeters:1/this.pixelsToMeters),e.translate(-this.getOffsetX(),-this.getOffsetY())}isPointInBounds(e,t,s){let r=!1;return s.save(),s.resetTransform(),this._generateViewportRect(s),r=s.isPointInPath(e,t),s.restore(),r}_generateViewportRect(e){let t=this.getViewportBounds();e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(t.w,t.y),e.lineTo(t.w,t.h),e.lineTo(t.x,t.h),e.closePath()}}function a(e,t=0){let s=1;for(let r=0;r<t;r++)s*=10;return Math.round(e*s)/s}t.Camera=o,t.default=o},"./src/core/canvas.ts":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e,t="2d"){this.dimension=t,"string"==typeof e?this.element=document.querySelector(e):e instanceof HTMLCanvasElement&&(this.element=e),this.setDimensions()}get context(){return this.getContext()}getContext(e=this.dimension,t={alpha:!1}){return this._context||(this._context=this.element.getContext(e,t))}setDimensions(e=window.innerWidth,t=window.innerHeight){return this.element.width=e,this.element.height=t,{width:e,height:t}}clear(e="white",t=this.context){t.fillStyle=e,t.clearRect(0,0,this.element.width,this.element.height),t.fillRect(0,0,this.element.width,this.element.height)}}t.Canvas=r,t.default=r},"./src/input/gamepad/controller.ts":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s("./src/input/manager.ts"),n=s("./src/input/gamepad/maps.ts");const i={};class o{constructor({pressed:e=!1,touched:t=!1,value:s=0}={},r){this.pressed=e,this.touched=t,this.value=s,this.last=null!=r?new o(r,null):null}get toggled(){return this.last&&this.last.pressed!==this.pressed}get buttonUp(){return this.toggled&&!this.pressed}get buttonDown(){return this.toggled&&this.pressed}}class a{constructor(){this.start=new o,this.select=new o,this.home=new o,this.left=new o,this.right=new o,this.up=new o,this.down=new o,this.l1=new o,this.l2=new o,this.l3=new o,this.r1=new o,this.r2=new o,this.r3=new o,this.triangle=new o,this.square=new o,this.circle=new o,this.cross=new o,this.extra=new o,this.lx=new o({value:0,pressed:!1,touched:!1}),this.ly=new o({value:0,pressed:!1,touched:!1}),this.rx=new o({value:0,pressed:!1,touched:!1}),this.ry=new o({value:0,pressed:!1,touched:!1})}vibrate(e){if(null!=this.gamepad){if(null!=this.gamepad.vibrationActuator){const t=null!=e.weakMagnitude?e.weakMagnitude:null!=e.value?e.value:void 0,s=null!=e.strongMagnitude?e.strongMagnitude:null!=e.value?e.value:void 0,r=null!=e.type?e.type:this.gamepad.vibrationActuator.type;return this.gamepad.vibrationActuator.playEffect(r,{duration:e.duration,startDelay:e.startDelay,weakMagnitude:t,strongMagnitude:s})}if(null!=this.gamepad.hapticActuators&&this.gamepad.hapticActuators.length){const t=null!=e.value?e.value:null!=e.weakMagnitude?e.weakMagnitude:e.strongMagnitude;let s=this.gamepad.hapticActuators;return null!=e.type&&(s=s.filter(t=>t.type===e.type)),Promise.all(s.map(s=>s.pulse(t,e.duration)))}}}}t.GamepadState=a;t.default=class{constructor(){this.state=new r.InputState(a),window.addEventListener("gamepadconnected",({gamepad:e,...t})=>{let s=navigator.getGamepads()[e.index];console.log(s);let r=this.findMappingForGamepad(e);r?(console.log(`${r.name} connected as controller ${e.index}.`),i[e.index]=r):(console.warn("No mapping found for gamepad at index %d: %s. %d buttons, %d axes.",e.index,e.id,e.buttons.length,e.axes.length),console.log(e))}),window.addEventListener("gamepaddisconnected",({gamepad:e,...t})=>{console.log("Gamepad disconnected: ",e)})}install(e){e.gamepad=this.state}findMappingForGamepad(e){return Object.values(n.default).find(t=>t.test(e))}get gamepads(){return Array.from(navigator.getGamepads()||[])}_parseGamepadState(e,t){const s=new a;if(null!=e){const r=this.findMappingForGamepad(e);s.gamepad=e,r&&(e.buttons.forEach((e,n)=>{const i=r.buttons[n];r.buttonAxes&&i in r.buttonAxes||(s[i]=new o(e,t[i]))}),e.axes.forEach((n,i)=>{const a=r.axes[i],l=r.sticks[a],h=r.buttonAxes?r.buttonAxes[a]:null,d=null!=h?r.buttons[h]:null,u=r.dpadAxes?r.dpadAxes[a]:null;if(null!=l)s[a]=new o({pressed:!1,touched:!1,value:n},s[a]);else if(null!=h){const r=e.buttons[h];s[d]=new o(r,t[d])}else null!=u&&Object.entries(u).forEach(([e,r])=>{const i=new o({pressed:!1,value:n,touched:!1},t[e]);i.id=e,r==n&&(i.pressed=!0),s[e]=i})}))}return s}update(e,t){this.gamepads.forEach((e,t)=>{this.state.set(t,this._parseGamepadState(e,this.state.get(t)))})}}},"./src/input/gamepad/maps.ts":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r={"ps4-1":{name:"PS4 Controller (Chrome;macOS)",buttons:["cross","circle","square","triangle","l1","r1","l2","r2","extra","start","l3","r3","up","down","left","right","home","select"],axes:["lx","ly","rx","ry"],sticks:{lx:"leftStick",ly:"leftStick",rx:"rightStick",ry:"rightStick"},test(e){let t=navigator.userAgent;return/54c.*5c4/.test(e.id)&&e.axes.length==this.axes.length&&e.buttons.length==this.buttons.length&&t.includes("Chrome")&&t.includes("Mac OS X")}},"ps4-2":{name:"PS4 Controller (Firefox;macOS)",buttons:["square","cross","circle","triangle","l1","r1","l2","r2","extra","start","l3","r3","home","select","up","down","left","right"],axes:["dpadX","dpadY","rx","l2","r2","ry"],sticks:{lx:"leftStick",ly:"leftStick",rx:"rightStick",ry:"rightStick"},buttonAxes:{l2:6,r2:7},dpadAxes:{dpadX:{left:-1,right:1},dpadY:{up:-1,down:1}},test(e){let t=navigator.userAgent;return/54c.*5c4/.test(e.id)&&e.axes.length==this.axes.length&&e.buttons.length==this.buttons.length&&t.includes("Firefox")&&t.includes("Mac OS X")}},"ps4-3":{name:"PS4 Controller (Firefox;Ubuntu)",buttons:["cross","circle","triangle","square","l1","r1","l2","r2","extra","start","home","l3","r3"],axes:["lx","ly","l2","rx","ry","r2","dpadX","dpadY"],sticks:{lx:"leftStick",ly:"leftStick",rx:"rightStick",ry:"rightStick"},buttonAxes:{l2:6,r2:7},dpadAxes:{dpadX:{left:-1,right:1},dpadY:{up:-1,down:1}},test(e){let t=navigator.userAgent;return/54c/.test(e.id)&&e.axes.length==this.axes.length&&e.buttons.length==this.buttons.length&&t.includes("Firefox")&&t.includes("Ubuntu")}},"ps4-4":{name:"PS4 Controller (Chrome;Linux;Wired)",buttons:["cross","circle","square","triangle","l1","r1","l2","r2","extra","start","l3","r3","up","down","left","right","home"],axes:["lx","ly","rx","ry"],sticks:{lx:"leftStick",ly:"leftStick",rx:"rightStick",ry:"rightStick"},test(e){let t=navigator.userAgent;return/054c/.test(e.id)&&e.axes.length==this.axes.length&&e.buttons.length==this.buttons.length&&t.includes("Chrome")&&t.includes("Linux")}},"ps4-5":{name:"PS4 Controller (Chrome;Linux;Wireless)",buttons:["circle","triangle","cross","square","l1","r1","rx","ry","select","start","home","l3","up","down","left","right","r3","extra"],axes:["lx","ly","l2","r2"],buttonAxes:{rx:6,ry:7},sticks:{lx:"leftStick",ly:"leftStick",rx:"rightStick",ry:"rightStick"},test(e){let t=navigator.userAgent;return/054c/.test(e.id)&&e.axes.length==this.axes.length&&e.buttons.length==this.buttons.length&&t.includes("Chrome")&&t.includes("Linux")}}};t.default=r},"./src/input/keyboard/controller.ts":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s("./src/input/manager.ts");class n{constructor(e=!1){this.down=e}}t.KeyState=n;t.default=class{constructor(){this.state=new r.InputState(n);let e=e=>{const{type:t,key:s,code:r}=e;let n="keydown"===t;this.state.set(s,{down:n}),this.state.set(r,{down:n})};window.addEventListener("keydown",e,!1),window.addEventListener("keyup",e,!1)}install(e){e.keyboard=this.state}}},"./src/input/manager.ts":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.InputState=class{constructor(e){this.state={},this._ctor=e}get(e){let t=this.state[e];return null==t&&(t=this.set(e,Reflect.construct(this._ctor,[]))),t}set(e,t){return this.state[e]=t}};class r{constructor(e=[]){this.inputControllers=[],e.forEach(e=>this.addController(e))}addController(e){e.install(this),this.inputControllers.push(e)}update(e,t){this.inputControllers.forEach(s=>{s.update&&s.update(e,t)})}}t.InputManager=r,t.default=r},"./src/input/mouse/controller.ts":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s("./src/input/manager.ts");class n{constructor(e=0,t=0,s=!1){this.x=e,this.y=t,this.down=s}}t.MouseState=n;t.default=class{constructor(){this.state=new r.InputState(n),window.addEventListener("mousemove",e=>{const{which:t,x:s,y:r}=e;this.state.set(t,{x:s,y:r,down:!1})},!1),window.addEventListener("mousedown",e=>{const{which:t,x:s,y:r}=e;this.state.set(t,{x:s,y:r,down:!0})},!1),window.addEventListener("mouseup",e=>{const{which:t,x:s,y:r}=e;this.state.set(t,{x:s,y:r,down:!1})},!1)}install(e){e.mouse=this.state}}},"./src/main.ts":function(e,t,s){"use strict";function r(e){for(var s in e)t.hasOwnProperty(s)||(t[s]=e[s])}Object.defineProperty(t,"__esModule",{value:!0});const n=s("./src/core/app.ts");r(s("./src/core/app.ts")),r(s("./src/core/camera.ts")),r(s("./src/core/canvas.ts")),r(s("./src/render/renderer.ts")),r(s("./src/screen/screen.ts")),r(s("./src/screen/screenManager.ts")),r(s("./src/input/manager.ts")),r(s("./src/input/keyboard/controller.ts"));var i=s("./src/input/keyboard/controller.ts");t.KeyboardController=i.default,r(s("./src/input/mouse/controller.ts"));var o=s("./src/input/mouse/controller.ts");t.MouseController=o.default,r(s("./src/input/gamepad/controller.ts"));var a=s("./src/input/gamepad/controller.ts");t.GamepadController=a.default,r(s("./src/reactivity/dep.ts")),r(s("./src/reactivity/lambda.ts")),r(s("./src/reactivity/state.ts")),r(s("./src/asset/asset.ts")),r(s("./src/asset/assetLoader.ts")),r(s("./src/asset/assetManager.ts")),r(s("./src/asset/audioAsset.ts")),r(s("./src/asset/audioAssetLoader.ts")),r(s("./src/asset/imageAsset.ts")),r(s("./src/asset/imageAssetLoader.ts")),r(s("./src/utils/vector2.ts")),t.default=n.default},"./src/reactivity/dep.ts":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let r=0;const n=[];t.pushLambda=function(e){n.push(e),i.lambda=e},t.popLambda=function(){n.pop(),i.lambda=n[n.length-1]};class i{constructor(){this.id=r++,this.lambdas=[]}addLambda(e){this.lambdas.push(e)}removeLambda(e){const t=this.lambdas.indexOf(e);t>-1&&this.lambdas.slice(t,1)}depend(){i.lambda&&i.lambda.addDep(this)}notify(){this.lambdas.forEach(e=>e.update())}}t.Dep=i,t.default=i},"./src/reactivity/lambda.ts":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s("./src/reactivity/dep.ts");class n{constructor(e,t){this.depIds=new Set,this.newDepIds=new Set,this.deps=[],this.newDeps=[],this.owner=e,this.fn=t,this.compute()}addDep(e){this.newDepIds.has(e.id)||(this.newDepIds.add(e.id),this.newDeps.push(e),this.depIds.has(e.id)||e.addLambda(this))}compute(){r.pushLambda(this),this.value=this.fn.call(this.owner,this.owner),r.popLambda(),this.clean()}clean(){this.deps.forEach(e=>{this.newDepIds.has(e.id)||e.removeLambda(this)});let e=this.depIds;this.depIds=this.newDepIds,this.newDepIds=e,this.newDepIds.clear(),e=this.deps,this.deps=this.newDeps,this.newDeps=e,this.newDeps.length=0}update(){this.compute()}}t.Lambda=n,t.default=n},"./src/reactivity/state.ts":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s("./src/reactivity/dep.ts"),n=Object.getOwnPropertyNames(Object.prototype),i=Object.getOwnPropertyNames(Array.prototype),o=new WeakMap;class a{constructor(e,t={}){const s=new Map,h=e=>{let t=s.get(e);return t||(t=new r.default,s.set(e,t),t)},{exclude:d=[],dep:u}=t,c=new Set(d);Array.isArray(e)?(i.forEach(e=>c.add(e)),e=l.create(e)):n.forEach(e=>c.add(e)),null!=e&&Object.defineProperty(e,"__state__",{value:this,enumerable:!1,configurable:!0,writable:!0});let p=new Proxy(e,{get(e,t){const s=Reflect.get(e,t);if(c.has(t))return s;const n=h(t);return r.default.lambda&&n.depend(),a.create(s,{dep:n})},set(e,t,s){const r=Reflect.get(e,t);if(c.has(t))return Reflect.set(e,t,s);const n=h(t);if(r===s)return!0;const i=Reflect.set(e,t,a.create(s,{dep:n}));return n.notify(),i}});return o.has(p)||null==u||o.set(p,u),p}static create(e,t={}){return"object"!=typeof e||null==e||e.hasOwnProperty("__state__")?e:new a(e,t)}static dep(e){return o.get(e)}}t.State=a,t.default=a;class l extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Object.create(l.prototype))}static create(e){return new l(e)}static notify(e){const t=a.dep(e);t&&t.notify()}push(...e){const t=Array.prototype.push.call(this,...e);return l.notify(this),t}pop(){const e=super.pop();return l.notify(this),e}shift(){const e=super.shift();return l.notify(this),e}unshift(...e){const t=super.unshift(...e);return l.notify(this),t}splice(e,t,...s){const r=super.splice(e,t,...s);return l.notify(this),r}sort(e){const t=super.sort(e);return l.notify(this),t}reverse(){const e=super.reverse();return l.notify(this),e}}},"./src/render/renderer.ts":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e,t=[]){this.name=e,this.args=t}}t.RenderingContextFunctionComponent=r;class n{constructor(e,t){this.name=e,this.value=t}}t.RenderingContextPropertyComponent=n;t.RenderingContext=class{constructor(){this.$components=[]}static render(e,t){e.$components.forEach(e=>{this.componentIsFunction(e)?t[e.name].apply(t,e.args):this.componentIsProperty(e)&&(t[e.name]=e.value)})}static componentIsFunction(e){return e.hasOwnProperty("args")}static componentIsProperty(e){return e.hasOwnProperty("value")}restore(){this.$components.push(new r("restore"))}save(){this.$components.push(new r("save"))}getTransform(){throw new Error("Method not implemented.")}resetTransform(){throw new Error("Method not implemented.")}rotate(e){throw new Error("Method not implemented.")}scale(e,t){throw new Error("Method not implemented.")}setTransform(e,t,s,r,n,i){throw new Error("Method not implemented.")}transform(e,t,s,r,n,i){throw new Error("Method not implemented.")}translate(e,t){throw new Error("Method not implemented.")}createLinearGradient(e,t,s,r){throw new Error("Method not implemented.")}createPattern(e,t){throw new Error("Method not implemented.")}createRadialGradient(e,t,s,r,n,i){throw new Error("Method not implemented.")}clearRect(e,t,s,r){throw new Error("Method not implemented.")}fillRect(e,t,s,r){throw new Error("Method not implemented.")}strokeRect(e,t,s,n){this.$components.push(new r("strokeRect",[e,t,s,n]))}beginPath(){throw new Error("Method not implemented.")}clip(e,t){throw new Error("Method not implemented.")}fill(e,t){throw new Error("Method not implemented.")}isPointInPath(e,t,s,n){this.$components.push(new r("restore"))}isPointInStroke(e,t,s){throw new Error("Method not implemented.")}stroke(e){throw new Error("Method not implemented.")}drawFocusIfNeeded(e,t){throw new Error("Method not implemented.")}scrollPathIntoView(e){throw new Error("Method not implemented.")}fillText(e,t,s,r){throw new Error("Method not implemented.")}measureText(e){throw new Error("Method not implemented.")}strokeText(e,t,s,r){throw new Error("Method not implemented.")}drawImage(e,t,s,r,n,i,o,a,l){throw new Error("Method not implemented.")}createImageData(e,t){throw new Error("Method not implemented.")}getImageData(e,t,s,r){throw new Error("Method not implemented.")}putImageData(e,t,s,r,n,i,o){throw new Error("Method not implemented.")}set lineWidth(e){this.$components.push(new n("lineWidth",e))}getLineDash(){throw new Error("Method not implemented.")}setLineDash(e){throw new Error("Method not implemented.")}arc(e,t,s,r,n,i){throw new Error("Method not implemented.")}arcTo(e,t,s,r,n){throw new Error("Method not implemented.")}bezierCurveTo(e,t,s,r,n,i){throw new Error("Method not implemented.")}closePath(){throw new Error("Method not implemented.")}ellipse(e,t,s,r,n,i,o,a){throw new Error("Method not implemented.")}lineTo(e,t){throw new Error("Method not implemented.")}moveTo(e,t){throw new Error("Method not implemented.")}quadraticCurveTo(e,t,s,r){throw new Error("Method not implemented.")}rect(e,t,s,r){throw new Error("Method not implemented.")}}},"./src/screen/screen.ts":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e={}){this.options=e}update(e,...t){}finish(e){this._isFinished||(this.onDestroy(),this._finalData=e||{},this._isFinished=!0)}onDestroy(){}onAddedToManager(e,t){}onRemovedFromManager(e){}}t.Screen=r,t.default=r},"./src/screen/screenManager.ts":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let r=1;const n=["onScreenAdded","onScreenFinished","onScreensRemoved","onWarnPopScreen"];class i{constructor(){this._listeners=new Proxy([],{get:(e,t)=>(function(e){return n.includes(e)})(t)?(...s)=>{e.forEach(e=>{null!=e[t]&&e[t].call(e,...s)})}:e[t]}),this._stack=[]}getNewId(){return r++}update(e){let t=this._stack;if(t.length>0){let e=t[t.length-1];e._isFinished?this._listeners.onScreenFinished(e,this,e._finalData):e.update.apply(e,arguments)}}addScreen(e,t=!1,s){let r=this._stack;if(e.$manager=this,e.$id=this.getNewId(),t){const[e]=this.popScreen();null!=e&&(s=e._finalData)}r.push(e),e.onAddedToManager(this,s),this._listeners.onScreenAdded(e,this,t)}popScreen(){let e=this._stack;if(e.length>0){let t=e.pop();return t.onRemovedFromManager(this),this._listeners.onScreensRemoved([t],this),[t]}return this._listeners.onWarnPopScreen(e,this),[]}popToScreen(e){let t=this._stack;if(!e.hasOwnProperty("$id"))return!1;let s=t.findIndex(t=>t.$id===e.$id);if(-1===s)return!1;{let e=t.splice(s);return e.slice().reverse().forEach(e=>e.onRemovedFromManager(this)),this._listeners.onScreensRemoved(e,this),e}}addScreenEventListener(e){this._listeners.push(e)}}t.ScreenManager=i,t.default=i},"./src/utils/vector2.ts":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e=0,t=0){this.x=e,this.y=t}get_x(){return this.x}get_y(){return this.y}set_x(e){this.x=e}set_y(e){this.y=e}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){const e=this.magnitude();return e>0&&this.scale(1/e),this}scale(e){return this.x=this.x*e,this.y=this.y*e,this}}t.Vector2=r,t.default=r}})});
},{}],"N8hG":[function(require,module,exports) {
"use strict";var o;Object.defineProperty(exports,"__esModule",{value:!0}),exports.ComponentSymbol=Symbol.for("Component");class e{constructor(){this[o]=!0}}o=exports.ComponentSymbol,exports.default=e;
},{}],"gwKN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class t{constructor(t){this.bits=t?new Uint8Array(t):new Uint8Array}get(t){return!!this.bits[t]}set(t){this.checkCapacity(t),this.bits[t]=1}checkCapacity(t){if(t>=this.bits.length){const i=new Uint8Array(t+1);i.set(this.bits),this.bits=i}}clear(t){if(t>=this.bits.length)return;this.bits[t]=0;let i=this.bits.lastIndexOf(1);this.bits=this.bits.slice(0,i+1)}length(){return this.bits.length}isEmpty(){const t=this.bits.length;for(let i=0;i<t;i++)if(0!=this.bits[i])return!1;return!0}nextSetBit(t=0){return this.bits.indexOf(1,t)}and(t){let i=Math.min(this.bits.length,t.bits.length);for(let s=0;i>s;s++)this.bits[s]&=t.bits[s];if(this.bits.length>i)for(let s=i,e=this.bits.length;e>s;s++)this.bits[s]=0}andNot(t){for(let i=0,s=this.bits.length,e=t.bits.length;i<s&&i<e;i++)this.bits[i]&=~t.bits[i]}or(t){let i=Math.min(this.bits.length,t.bits.length);for(let s=0;i>s;s++)this.bits[s]|=t.bits[s];if(i<t.bits.length){this.checkCapacity(t.bits.length);for(let s=i,e=t.bits.length;e>s;s++)this.bits[s]=t.bits[s]}}xor(t){let i=Math.min(this.bits.length,t.bits.length);for(let s=0;i>s;s++)this.bits[s]^=t.bits[s];if(i<t.bits.length){this.checkCapacity(t.bits.length);for(let s=i,e=t.bits.length;e>s;s++)this.bits[s]=t.bits[s]}}intersects(t){let i=this.bits,s=t.bits;for(let e=Math.min(i.length,s.length)-1;e>=0;e--)if(0!=(i[e]&s[e]))return!0;return!1}containsAll(t){const i=this.bits,s=t.bits,e=s.length,h=i.length;for(let n=h;n<e;n++)if(0!=s[n])return!1;for(let n=Math.min(h,e)-1;n>=0;n--)if((i[n]&s[n])!=s[n])return!1;return!0}hashCode(){const t=this.length()>>>6;let i=0;for(let s=0;t>=s;s++)i=127*i+(this.bits[s]^this.bits[s]>>>32);return i}equals(t){if(this==t)return!0;if(null==t)return!1;let i=t,s=i.bits,e=Math.min(this.bits.length,s.length);for(let h=0;e>h;h++)if(this.bits[h]!=s[h])return!1;return this.bits.length==s.length||this.length()==i.length()}}exports.default=t;
},{}],"VKbi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("./Bits");class e{constructor(){this.index=e.typeIndex++}getIndex(){return this.index}static reset(){this.typeIndex=0}static getFor(t){let r=e.classMap.get(t);return r||(r=new e,e.classMap.set(t,r)),r}static getIndexFor(t){return this.getFor(t).getIndex()}static getBitsFor(r){let s=new t.default;const n=r.length;for(let t=0;t<n;t++)s.set(e.getIndexFor(r[t]));return s}hashCode(){return this.index}equals(t){if(this==t)return!0;if(null==t)return!1;if(this.constructor.prototype!=t.constructor.prototype)return!1;let e=t;return this.index==e.index}}e.classMap=new WeakMap,e.typeIndex=0,exports.default=e;
},{"./Bits":"gwKN"}],"Psni":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("./ComponentType");class t{constructor(t){this.componentType=e.default.getFor(t)}static getFor(e){return new t(e)}get(e){return e.getComponent(this.componentType)}has(e){return e.hasComponent(this.componentType)}}exports.default=t;
},{"./ComponentType":"VKbi"}],"oomk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("./Bits"),e=require("./ComponentType"),s=new t.default;class i{constructor(t,e,s){this.allBits=t,this.oneBits=e,this.excludeBits=s,this.index=i.familyIndex++}getIndex(){return this.index}matches(t){const e=t.getComponentBits();return!!e.containsAll(this.allBits)&&(!(!this.oneBits.isEmpty()&&!this.oneBits.intersects(e))&&!(!this.excludeBits.isEmpty()&&this.excludeBits.intersects(e)))}static all(t){return this.builder.reset().all(t)}static one(t){return this.builder.reset().one(t)}static exclude(t){return this.builder.reset().exclude(t)}hashCode(){return this.index}equals(t){return this==t}static getFamilyHash(t,e,s){let i="";return t.isEmpty()||(i=i+"{all:"+this.getBitsString(t)+"}"),e.isEmpty()||(i=i+"{one:"+this.getBitsString(e)+"}"),s.isEmpty()||(i=i+"{exclude:"+this.getBitsString(s)+"}"),i}static getBitsString(t){let e="";const s=t.length();for(let i=0;i<s;++i)e+=t.get(i)?"1":"0";return e}}i.Builder=class{constructor(){this.allBits=s,this.oneBits=s,this.excludeBits=s}reset(){return this.allBits=s,this.oneBits=s,this.excludeBits=s,this}all(t){return this.allBits=e.default.getBitsFor(t),this}one(t){return this.oneBits=e.default.getBitsFor(t),this}exclude(t){return this.excludeBits=e.default.getBitsFor(t),this}get(){let t=i.getFamilyHash(this.allBits,this.oneBits,this.excludeBits),e=i.families.get(t);return e||(e=new i(this.allBits,this.oneBits,this.excludeBits),i.families.set(t,e)),e}},i.families=new Map,i.familyIndex=0,i.builder=new i.Builder,i.zeroBits=new t.default,exports.default=i;
},{"./Bits":"gwKN","./ComponentType":"VKbi"}],"wW9q":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class e{constructor(){this.listeners=[]}add(e){this.listeners.push(e)}remove(e){this.listeners.splice(this.listeners.indexOf(e),1)}removeAllListeners(){this.listeners=[]}dispatch(e){this.listeners.forEach(s=>{s.receive(this,e)})}}exports.default=e;
},{}],"HEv2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("./Bits"),e=require("./Signal"),n=require("./ComponentType");class o{constructor(){this.removing=!1,this.componentMap=new Map,this.components=[],this.componentBits=new t.default,this.familyBits=new t.default,this.flags=0,this.componentAdded=new e.default,this.componentRemoved=new e.default}add(t){return this.addInternal(t)&&this.notifyComponentAdded(),this}addAndReturn(t){return this.add(t),t}remove(t){const e=n.default.getFor(t).getIndex(),o=this.componentMap.get(e);return null!=o&&null!=this.removeInternal(t)&&this.notifyComponentRemoved(),o}removeAll(){for(;this.components.length;)this.remove(this.components[0].constructor.prototype)}getComponent(t){return t instanceof n.default?this.componentMap.get(t.getIndex()):this.getComponent(n.default.getFor(t))}getComponents(){return this.components}hasComponent(t){return this.componentBits.get(t.getIndex())}getComponentBits(){return this.componentBits}getFamilyBits(){return this.familyBits}notifyComponentAdded(){this.componentAdded.dispatch(this)}notifyComponentRemoved(){this.componentRemoved.dispatch(this)}addInternal(t){const e=t.constructor.prototype,o=this.getComponent(e.constructor);if(t==o)return!1;null!=o&&this.removeInternal(e.constructor);const s=n.default.getIndexFor(e.constructor);return this.componentMap.set(s,t),this.components.push(t),this.componentBits.set(s),!0}removeInternal(t){const e=n.default.getFor(t).getIndex(),o=this.componentMap.get(e);if(null!=o)return this.componentMap.delete(e),this.components.splice(this.components.indexOf(o),1),this.componentBits.clear(e),o}}exports.default=o;
},{"./Bits":"gwKN","./Signal":"wW9q","./ComponentType":"VKbi"}],"WNGC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class e{constructor(e=0){this.sleepTime=0,this.priority=e,this.processing=!0}addedToEngine(e){}removedFromEngine(e){}update(e){}checkProcessing(e){return this.processing||this.dream(e)}setProcessing(e){this.processing=e,this.processing&&this.wake()}sleep(e){this.sleeping=!0,this.sleepTime=e,this.processing=!1}wake(){this.sleepTime=0,this.sleeping=!1,this.processing=!0}dream(e){return this.sleepTime-=e,this.sleepTime<=0&&this.wake(),!1}getEngine(){return this.engine}addedToEngineInternal(e){this.engine=e,this.addedToEngine(e)}removedFromEngineInternal(e){this.engine=null,this.removedFromEngine(e)}}exports.default=e;
},{}],"ac3j":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class e{constructor(){}add(e){e.notifyComponentAdded()}remove(e){e.notifyComponentRemoved()}}exports.default=e;
},{}],"QPId":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("./Bits");class e{constructor(t){this.familyToEntitesMap=new WeakMap,this.entityListenerMasks=new Map,this.families=[],this.entityListeners=[],this.notifying=!1,this.entities=t}getEntitiesFor(t){return this.registerFamily(t)}addEntityListener(t,e=0,s){s&&this.registerFamily(s);let n=0;for(;n<this.entityListeners.length&&this.entityListeners[n].priority<=e;)n++;for(let i of this.entityListenerMasks.values()){for(let t=i.length();t>n;t--)i.get(t-1)?i.set(t):i.clear(t);i.clear(n)}if(s){let t=this.entityListenerMasks.get(s);t&&t.set(n)}const r=new i;r.listener=t,r.priority=e,this.entityListeners.splice(n,0,r)}removeEntityListener(t){for(let e=0;e<this.entityListeners.length;e++){let i=this.entityListeners[e];if(i.listener==t){for(let t of this.entityListenerMasks.values())for(let i=e,s=t.length();i<s;i++)t.get(i+1)?t.set(i):t.clear(i);this.entityListeners.splice(this.entityListeners.indexOf(i),1)}}}updateFamilyMembership(e){let i=new t.default,s=new t.default;this.entityListenerMasks.forEach((t,n,r)=>{const l=n.getIndex(),a=e.getFamilyBits();let h=a.get(l),y=n.matches(e)&&!e.removing;if(h!=y){const t=this.entityListenerMasks.get(n),r=this.familyToEntitesMap.get(n);y?(t&&i.or(t),r&&r.push(e),a.set(l)):(t&&s.or(t),r&&(r.splice(r.indexOf(e),1),this.familyToEntitesMap.set(n,r)),a.clear(l))}}),this.notifying=!0;try{for(let t=s.nextSetBit(0);t>=0;t=s.nextSetBit(t+1))this.entityListeners[t].listener.entityRemoved(e);for(let t=i.nextSetBit(0);t>=0;t=i.nextSetBit(t+1))this.entityListeners[t].listener.entityAdded(e)}finally{this.notifying=!1}}registerFamily(e){const i=this.familyToEntitesMap.get(e);if(!i){this.familyToEntitesMap.set(e,[]),this.entityListenerMasks.set(e,new t.default);this.familyToEntitesMap.get(e);this.entities.forEach(t=>{this.updateFamilyMembership(t)}),this.families.push(e)}return i||[]}}exports.default=e;class i{}exports.EntityListenerData=i;
},{"./Bits":"gwKN"}],"2Ojl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class e extends Error{constructor(e){super(e),this.name="EinException"}}exports.EinException=e;class t extends e{constructor(e){super(e),this.name="IllegalStateException"}}exports.IllegalStateException=t;
},{}],"W5wf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("./Entity"),e=require("./exceptions");class i{constructor(t){this.entities=[],this.listener=t}addEntity(t){if(this.entities.indexOf(t)>-1)throw new e.IllegalStateException("Entity has already been added \n"+t);this.entities.push(t),this.listener.entityAdded(t)}removeEntity(t){const e=this.entities.indexOf(t);e>-1&&(this.entities.splice(e,1),this.listener.entityRemoved(t))}getSingleton(){return null==this.singletonEntity&&(this.singletonEntity=new t.default,this.addEntity(this.singletonEntity)),this.singletonEntity}removeAllEntities(t){if(t)for(;t.length;)this.removeEntity(t[0]),t.splice(0,1);else for(;this.entities.length;)this.removeEntity(this.entities[0])}getEntities(){return this.entities}}exports.default=i;
},{"./Entity":"HEv2","./exceptions":"2Ojl"}],"IDsC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class s{constructor(s){this.systems=[],this.systemMap=new WeakMap,this.listener=s}addSystem(s){this.systemMap.get(s.constructor)&&this.removeSystem(s),this.systemMap.set(s.constructor,s),this.systems.push(s),this.systems.sort(this.systemComparator),this.listener.systemAdded(s)}removeSystem(s){for(let t=0;t<this.systems.length;t++){this.systems[t].constructor.prototype==s.constructor.prototype&&this.systems.splice(t,1)}this.systemMap.delete(s.constructor),this.listener.systemRemoved(s)}removeAllSystems(){for(;this.systems.length;)this.removeSystem(this.systems[0])}getSystem(s){return this.systemMap.get(s)}getSystems(){return this.systems}systemComparator(s,t){return s.priority>t.priority?1:s.priority==t.priority?0:-1}}exports.default=s;
},{}],"6/wa":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("./ComponentManager"),t=require("./FamilyManager"),n=require("./Entity"),i=require("./EntityManager"),s=require("./SystemManager"),a=require("./exceptions"),r=require("./ComponentMapper");class o{constructor(){this.componentAdded=new g(this),this.componentRemoved=new g(this),this.systemManager=new s.default(new d(this)),this.entityManager=new i.default(new m(this)),this.familyManager=new t.default(this.entityManager.getEntities()),this.componentManager=new e.default}createEntity(){return new n.default}addEntity(e){this.entityManager.addEntity(e)}getSingleton(){return this.entityManager.getSingleton()}addSingletonComponent(e){return this.getSingleton().addAndReturn(e)}getSingletonComponent(e){return e instanceof r.default?e.get(this.getSingleton()):this.getSingleton().getComponent(e)}removeEntity(e){this.entityManager.removeEntity(e)}removeAllEntities(e){e?this.entityManager.removeAllEntities(this.getEntitiesFor(e)):this.entityManager.removeAllEntities()}getEntities(){return this.entityManager.getEntities()}addSystem(e){this.systemManager.addSystem(e)}removeSystem(e){this.systemManager.removeSystem(e)}removeAllSystems(){this.systemManager.removeAllSystems()}getSystem(e){return this.systemManager.getSystem(e)}getSystems(){return this.systemManager.getSystems()}getEntitiesFor(e){return this.familyManager.getEntitiesFor(e)}addEntityListener(e,t=0,n){this.familyManager.addEntityListener(e,t,n)}removeEntityListener(e){this.familyManager.removeEntityListener(e)}update(e){if(this.updating)throw new a.IllegalStateException("Cannot call update() on an Engine that is already updating.");this.updating=!0;const t=this.systemManager.getSystems();try{t.forEach(t=>{t.checkProcessing(e)&&t.update(e)})}finally{this.updating=!1}}addEntityInternal(e){e.componentAdded.add(this.componentAdded),e.componentRemoved.add(this.componentRemoved),this.familyManager.updateFamilyMembership(e)}removeEntityInternal(e){this.familyManager.updateFamilyMembership(e),e.componentAdded.remove(this.componentAdded),e.componentRemoved.remove(this.componentRemoved)}}exports.default=o;class d{constructor(e){this.engine=e}systemAdded(e){e.addedToEngineInternal(this.engine)}systemRemoved(e){e.removedFromEngineInternal(this.engine)}}class m{constructor(e){this.engine=e}entityAdded(e){this.engine.addEntityInternal(e)}entityRemoved(e){this.engine.removeEntityInternal(e)}}class g{constructor(e){this.engine=e}receive(e,t){this.engine.familyManager.updateFamilyMembership(t)}}
},{"./ComponentManager":"ac3j","./FamilyManager":"QPId","./Entity":"HEv2","./EntityManager":"W5wf","./SystemManager":"IDsC","./exceptions":"2Ojl","./ComponentMapper":"Psni"}],"OxCy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("../System");class t extends e.default{constructor(e,t=0){super(t),this.family=e}addedToEngine(e){this.entities=e.getEntitiesFor(this.family),this.engine=e}removedFromEngine(){this.entities=[]}update(e){this.engine&&(this.entities=this.engine.getEntitiesFor(this.family)),this.entities.forEach(t=>{this.processEntity(t,e)})}}exports.default=t;
},{"../System":"WNGC"}],"KtiX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("../System");class e extends t.default{constructor(t,e=0){super(e),this.interval=t,this.accumulator=0}update(t){for(this.accumulator+=t;this.accumulator>=this.interval;)this.accumulator-=this.interval,this.updateInterval()}}exports.default=e;
},{"../System":"WNGC"}],"sCu2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("../System");class e extends t.default{constructor(t,e,i=0){super(i),this.family=t,this.comparator=e}addedToEngine(t){this.entities=t.getEntitiesFor(this.family),this.engine=t}removedFromEngine(){this.entities=[]}update(t){this.engine&&(this.entities==this.engine.getEntitiesFor(this.family)?this.entities.forEach(e=>{this.proccessEntity(e,t)}):(this.entities=this.engine.getEntitiesFor(this.family).sort(this.comparator),this.entities.forEach(e=>{this.proccessEntity(e,t)})))}}exports.default=e;
},{"../System":"WNGC"}],"0eJ3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Component");exports.Component=e.default;var r=require("./ComponentType");exports.ComponentType=r.default;var t=require("./ComponentMapper");exports.ComponentMapper=t.default;var a=require("./Family");exports.Family=a.default;var o=require("./Entity");exports.Entity=o.default;var p=require("./System");exports.System=p.default;var n=require("./Engine");exports.Engine=n.default;var s=require("./helpers/IteratingSystem");exports.IteratingSystem=s.default;var u=require("./helpers/IntervalSystem");exports.IntervalSystem=u.default;var i=require("./helpers/SortedIteratingSystem");exports.SortedIteratingSystem=i.default;
},{"./Component":"N8hG","./ComponentType":"VKbi","./ComponentMapper":"Psni","./Family":"oomk","./Entity":"HEv2","./System":"WNGC","./Engine":"6/wa","./helpers/IteratingSystem":"OxCy","./helpers/IntervalSystem":"KtiX","./helpers/SortedIteratingSystem":"sCu2"}],"TbHe":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@ludic/ein");class t extends e.Component{constructor(e){super(),this.index=e}}exports.default=t;
},{"@ludic/ein":"0eJ3"}],"6PJe":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@ludic/ein");class t extends e.Component{constructor(e,t){super(),this.x=e,this.y=t}}exports.default=t;
},{"@ludic/ein":"0eJ3"}],"ssEh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@ludic/ein");class t extends e.Component{constructor(e=1,t="type1"){super(),this.boostMultiplier=1.2,this.building=!1,this._speed=.5,this.size=e,this.vibrating=!1,this.playerType=t,"type1"==this.playerType?this.color="rgba(192, 57, 43,1.0)":this.color="orange"}get speed(){return this.boosting?this._speed*this.boostMultiplier:this._speed}}exports.default=t;
},{"@ludic/ein":"0eJ3"}],"4ppt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;class t{constructor(t,s,e,r){this.r=t,this.g=s,this.b=e,this.a=r}toString(){return`rgba(${this.r}, ${this.g}, ${this.b}, ${this.a})`}}exports.default=t;
},{}],"OFwJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@ludic/ein"),t=r(require("../utils/Color"));function r(e){return e&&e.__esModule?e:{default:e}}const i={1:{r:46,g:204,b:113,a:0},2:{r:52,g:152,b:219,a:0},3:{r:155,g:89,b:182,a:0},4:{r:241,g:196,b:15,a:0},5:{r:231,g:76,b:60,a:0}};class s extends e.Component{constructor(e,t="1",r=!1){super(),this.building=!1,this.hex=e,this.active=r,this.tileType=t,this.playersOn=[]}get color(){return this.building?"green":"rgba(230, 126, 34, 0.2)"}get fill(){let e=i[this.tileType],r=new t.default(e.r,e.g,e.b,e.a);return this.active?r.a=.4:r.a=.1,r.toString()}}exports.default=s;
},{"@ludic/ein":"0eJ3","../utils/Color":"4ppt"}],"kL3g":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=a(require("@ludic/ludic")),t=require("@ludic/ein"),n=r(require("../components/GamepadComponent")),o=r(require("../components/PositionComponent")),l=r(require("../components/PlayerStateComponent")),i=r(require("../components/TileStateComponent"));function r(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}class p extends t.IteratingSystem{constructor(e){super(t.Family.all([n.default,o.default,l.default]).get()),this.pm=new t.ComponentMapper(o.default),this.gm=new t.ComponentMapper(n.default),this.psm=new t.ComponentMapper(l.default),this.tm=new t.ComponentMapper(i.default),this.gamepadDeadzone=.3,this.engine=e}exportMap(){let e={tiles:this.engine.getEntitiesFor(t.Family.all([i.default]).get()).map(e=>{let t=this.tm.get(e);return{pos:{x:t.hex.x,y:t.hex.y,z:t.hex.z},tileType:t.tileType}}),castles:[{x:2,y:0,z:-2}],playerSpawnPoints:[{x:1,y:1,z:-2},{x:3,y:-1,z:2}]};console.log(JSON.stringify(e))}processEntity(t,n){const o=this.pm.get(t),l=this.gm.get(t),r=this.psm.get(t),a=e.default.input.gamepad.get(l.index);if(o){const t=new e.Vector2(0,0);if(a.lx.value>=this.gamepadDeadzone?t.x=a.lx.value:a.lx.value<=-this.gamepadDeadzone&&(t.x=a.lx.value),a.ly.value>=this.gamepadDeadzone?t.y=-a.ly:a.ly.value<=-this.gamepadDeadzone&&(t.y=-a.ly),a.circle.buttonDown?r.boosting=!0:a.circle.buttonUp&&(r.boosting=!1),t.scale(r.speed),o.x+=t.x,o.y+=t.y,null!=r.currentTile){let e=r.currentTile.getComponent(i.default),t=a.rx.value,n=a.ry.value;console.log(n),t>0&&n>0&&(e.tileType="1"),t<0&&n>0&&(e.tileType="2"),t>0&&n<0&&(e.tileType="3"),t<0&&n<0&&(e.tileType="4"),a.home.buttonUp&&this.exportMap()}}}}exports.default=p;
},{"@ludic/ludic":"jftt","@ludic/ein":"0eJ3","../components/GamepadComponent":"TbHe","../components/PositionComponent":"6PJe","../components/PlayerStateComponent":"ssEh","../components/TileStateComponent":"OFwJ"}],"euBU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@ludic/ein");class r extends e.Component{constructor(e){super(),this.renderFn=e}}exports.default=r;
},{"@ludic/ein":"0eJ3"}],"EAp9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@ludic/ein");class t extends e.Component{constructor(e){super(),this.type=e}}exports.default=t;
},{"@ludic/ein":"0eJ3"}],"UqyC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@ludic/ein");class t extends e.Component{constructor(e){super(),this.camera=e}}exports.default=t;
},{"@ludic/ein":"0eJ3"}],"fAdk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CameraComponentMapper=exports.GamepadComponentMapper=exports.PositionComponentMapper=exports.MechComponentMapper=void 0;var e=require("@ludic/ein"),o=r(require("./MechComponent")),p=r(require("./PositionComponent")),n=r(require("./GamepadComponent")),t=r(require("./CameraComponent"));function r(e){return e&&e.__esModule?e:{default:e}}const a=new e.ComponentMapper(o.default);exports.MechComponentMapper=a;const m=new e.ComponentMapper(p.default);exports.PositionComponentMapper=m;const s=new e.ComponentMapper(n.default);exports.GamepadComponentMapper=s;const C=new e.ComponentMapper(t.default);exports.CameraComponentMapper=C;
},{"@ludic/ein":"0eJ3","./MechComponent":"EAp9","./PositionComponent":"6PJe","./GamepadComponent":"TbHe","./CameraComponent":"UqyC"}],"XPTO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@ludic/ein"),t=r(require("../components/PositionComponent")),n=r(require("../components/RenderComponent")),i=r(require("../components/PlayerStateComponent")),s=r(require("@ludic/ludic")),o=require("../components/mappers");function r(e){return e&&e.__esModule?e:{default:e}}class a extends e.System{constructor(){super(),this.rm=e.ComponentMapper.getFor(n.default),this.pm=e.ComponentMapper.getFor(t.default),this.sm=e.ComponentMapper.getFor(i.default),this.components=[i.default],this.family=e.Family.all(this.components).get()}addedToEngine(e){this.entities=e.getEntitiesFor(this.family),this.engine=e}removedFromEngine(e){this.entities=[]}update(e){const t=s.default.canvas.context;this.engine&&(this.entities=this.engine.getEntitiesFor(this.family)),t.save();const{camera:n}=this.engine.getSingletonComponent(o.CameraComponentMapper);n.drawAxes(t),this.entities.forEach(e=>{t.save(),this.renderPlayer(t,e),t.restore()}),t.restore()}renderPlayer(e,t){this.rm.get(t);const n=this.pm.get(t),i=this.sm.get(t),s=o.MechComponentMapper.get(t);e.fillStyle=s.type,e.beginPath(),e.arc(n.x+i.size/2,n.y+i.size/2,i.size,0,2*Math.PI),e.fill()}}exports.default=a;
},{"@ludic/ein":"0eJ3","../components/PositionComponent":"6PJe","../components/RenderComponent":"euBU","../components/PlayerStateComponent":"ssEh","@ludic/ludic":"jftt","../components/mappers":"fAdk"}],"h6wx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@ludic/ein"),t=n(require("../components/PositionComponent")),i=n(require("../components/TileStateComponent")),s=n(require("@ludic/ludic"));function n(e){return e&&e.__esModule?e:{default:e}}class o extends e.System{constructor(){super(),this.pm=e.ComponentMapper.getFor(t.default),this.tm=e.ComponentMapper.getFor(i.default),this.components=[i.default],this.family=e.Family.all(this.components).get()}addedToEngine(e){this.entities=e.getEntitiesFor(this.family),this.engine=e}removedFromEngine(e){this.entities=[]}update(e){const t=s.default.canvas.context;this.engine&&(this.entities=this.engine.getEntitiesFor(this.family)),t.save(),this.entities.forEach(e=>{t.save();const i=this.pm.get(e),n=this.tm.get(e),o=i.x,l=i.y;t.strokeStyle=n.color,t.fillStyle=n.fill,t.lineWidth=.1,t.beginPath(),t.moveTo(o+n.hex.sideLength*Math.cos(0),l+n.hex.sideLength*Math.sin(0));for(let s=0;s<7;s++)t.lineTo(o+n.hex.sideLength*Math.cos(2*s*Math.PI/6),l+n.hex.sideLength*Math.sin(2*s*Math.PI/6));t.fill(),t.stroke(),s.default.debug&&(t.save(),t.font="1px serif",t.fillStyle="black",t.scale(1,-1),t.fillText(`${n.hex.x}  ${n.hex.y}  ${n.hex.z}`,o-1.5,-l),t.restore()),t.restore()}),t.restore()}}exports.default=o;
},{"@ludic/ein":"0eJ3","../components/PositionComponent":"6PJe","../components/TileStateComponent":"OFwJ","@ludic/ludic":"jftt"}],"faAT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Vector2Normalize=exports.Vector2Distance=void 0;var t=require("@ludic/ludic");const e=function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))};exports.Vector2Distance=e;const r=function(e){const r=Math.sqrt(e.x*e.x+e.y*e.y);return new t.Vector2(e.x/r,e.y/r)};exports.Vector2Normalize=r;
},{"@ludic/ludic":"jftt"}],"2Va8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=l(require("@ludic/ludic")),t=require("@ludic/ein"),i=o(require("../components/PositionComponent")),s=o(require("../components/TileStateComponent")),n=o(require("../components/PlayerStateComponent")),r=require("../utils/Euclid");function o(e){return e&&e.__esModule?e:{default:e}}function l(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var s=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,i):{};s.get||s.set?Object.defineProperty(t,i,s):t[i]=e[i]}return t.default=e,t}class c extends t.System{constructor(){super(),this.pm=t.ComponentMapper.getFor(i.default),this.psm=t.ComponentMapper.getFor(n.default),this.tsm=t.ComponentMapper.getFor(s.default),this.components=[i.default],this.family=t.Family.all(this.components).get()}addedToEngine(e){this.entities=e.getEntitiesFor(this.family),this.engine=e}removedFromEngine(e){this.entities=[]}update(t){e.default.canvas.context;this.engine&&(this.entities=this.engine.getEntitiesFor(this.family));const i=this.entities.filter(e=>!!this.psm.get(e)),s=this.entities.filter(e=>!!this.tsm.get(e));if(i.length){let t=i.map(e=>{const t=this.pm.get(e),i=this.psm.get(e);return{player:e,closestTile:null,closestTileDistance:null,cX:t.x+i.size/2,cY:t.y+i.size/2}});s.forEach(i=>{this.tsm.get(i);let s=this.pm.get(i),n=s.x,o=s.y;t.forEach(t=>{const s=new e.Vector2(t.cX,t.cY),l=new e.Vector2(n,o),c=(0,r.Vector2Distance)(s,l);(null==t.closestTileDistance||t.closestTileDistance>c)&&(t.closestTileDistance=c,t.closestTile=i)})}),s.forEach(e=>{let i=this.tsm.get(e);i.playersOn=[],i.active=!1,t.forEach(t=>{t.closestTile==e&&(i.active=!0,i.playersOn.push(t.player))})}),t.forEach(e=>{this.psm.get(e.player).currentTile=e.closestTile})}}}exports.default=c;
},{"@ludic/ludic":"jftt","@ludic/ein":"0eJ3","../components/PositionComponent":"6PJe","../components/TileStateComponent":"OFwJ","../components/PlayerStateComponent":"ssEh","../utils/Euclid":"faAT"}],"jDa/":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@ludic/ein");class t extends e.Component{constructor(e,t=10,s=2){super(),this.hex=e,this.health=t,this.size=s}}exports.default=t;
},{"@ludic/ein":"0eJ3"}],"R2O5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=s(require("@ludic/ludic")),t=require("@ludic/ein"),i=s(require("../components/CastleStateComponent"));function s(e){return e&&e.__esModule?e:{default:e}}class n extends t.System{constructor(){super(),this.tm=t.ComponentMapper.getFor(i.default),this.components=[i.default],this.family=t.Family.all(this.components).get()}addedToEngine(e){this.entities=e.getEntitiesFor(this.family),this.engine=e}removedFromEngine(e){this.entities=[]}update(t){const i=e.default.canvas.context;this.entities=this.engine.getEntitiesFor(this.family),i.save(),this.entities.forEach(e=>{const t=this.tm.get(e),s=t.hex.position;i.save(),i.fillStyle="lightgreen",i.beginPath(),i.moveTo(s.x-t.size/2,s.y-t.size/2),i.lineTo(s.x,s.y+t.size/2),i.lineTo(s.x+t.size/2,s.y-t.size/2),i.fill(),i.restore()}),i.restore()}}exports.default=n;
},{"@ludic/ludic":"jftt","@ludic/ein":"0eJ3","../components/CastleStateComponent":"jDa/"}],"uXR5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@ludic/ein");class t extends e.Component{constructor(e,t,s,r="1",i=.1,o=10,u=1){super(),this.currentHex=e,this.previousHex=null,this.wave=t,this.group=s,this.type=r,this.speed=i,this.health=o,this.color="red",this.size=u}}exports.default=t;
},{"@ludic/ein":"0eJ3"}],"FwEM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=o(require("@ludic/ludic")),t=require("@ludic/ein"),i=o(require("../components/CastleStateComponent")),s=o(require("../components/EnemyStateComponent")),n=o(require("../components/PositionComponent"));function o(e){return e&&e.__esModule?e:{default:e}}class r extends t.System{constructor(){super(),this.csm=t.ComponentMapper.getFor(i.default),this.esm=t.ComponentMapper.getFor(s.default),this.pm=t.ComponentMapper.getFor(n.default),this.components=[i.default,s.default],this.family=t.Family.one(this.components).get()}addedToEngine(e){this.entities=e.getEntitiesFor(this.family),this.engine=e}removedFromEngine(e){this.entities=[]}update(t){e.default.canvas.context;this.entities=this.engine.getEntitiesFor(this.family);const i=this.entities.filter(e=>!!this.csm.get(e)),s=this.entities.filter(e=>!!this.esm.get(e));if(i.length){let e=this.pm.get(i[0]),t=this.csm.get(i[0]);s.forEach(i=>{let s=this.pm.get(i);Math.abs(e.x-s.x)<.05&&Math.abs(e.y-s.y)<.05&&(t.health-=1,i.removing=!0,this.engine.removeEntity(i))})}}}exports.default=r;
},{"@ludic/ludic":"jftt","@ludic/ein":"0eJ3","../components/CastleStateComponent":"jDa/","../components/EnemyStateComponent":"uXR5","../components/PositionComponent":"6PJe"}],"mrzr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;class e{}exports.default=e;
},{}],"UofZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@ludic/ein"),t=require("@ludic/ludic");class r extends e.Component{constructor(){super(...arguments),this.velocity=new t.Vector2,this.accel=new t.Vector2}}exports.default=r;
},{"@ludic/ein":"0eJ3","@ludic/ludic":"jftt"}],"kbAB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@ludic/ein"),t=r(require("../components/MovementComponent")),o=r(require("../components/PositionComponent")),n=r(require("../components/PlayerStateComponent"));function r(e){return e&&e.__esModule?e:{default:e}}class s extends e.Entity{constructor(e){super(),this.add(new o.default(e.position.x,e.position.y)),this.add(new t.default),this.add(new n.default)}}exports.default=s;
},{"@ludic/ein":"0eJ3","../components/MovementComponent":"UofZ","../components/PositionComponent":"6PJe","../components/PlayerStateComponent":"ssEh"}],"7bCE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@ludic/ein"),t=n(require("../components/PositionComponent")),o=n(require("../components/TileStateComponent"));function n(e){return e&&e.__esModule?e:{default:e}}class i extends e.Entity{constructor(e,n="1",i=!1){super(),this.add(new t.default(e.position.x,e.position.y)),this.add(new o.default(e,n,i))}}exports.default=i;
},{"@ludic/ein":"0eJ3","../components/PositionComponent":"6PJe","../components/TileStateComponent":"OFwJ"}],"0bx0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@ludic/ein"),t=n(require("../components/CastleStateComponent")),o=n(require("../components/PositionComponent"));function n(e){return e&&e.__esModule?e:{default:e}}class s extends e.Entity{constructor(e){super(),this.add(new o.default(e.position.x,e.position.y)),this.add(new t.default(e))}}exports.default=s;
},{"@ludic/ein":"0eJ3","../components/CastleStateComponent":"jDa/","../components/PositionComponent":"6PJe"}],"BY5F":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=require("@ludic/ludic");class e{constructor(t,e,r,s){this.x=t,this.y=e,this.z=r,this.q=t,this.r=r,this.sideLength=s}get position(){return e.cubeCoordinateToVector2({x:this.x,y:this.y,z:this.z},this.sideLength)}static add(t,r){return new e(t.x+r.x,t.y+r.y,t.z+r.z,t.sideLength+r.sideLength)}static subtract(t,r){return new e(t.x-r.x,t.y-r.y,t.z-r.z,t.sideLength-r.sideLength)}static equal(t,e){return t.x==e.x&&t.y==e.y&&t.z==e.z}static scale(t,r){return new e(t.x*r,t.y*r,t.z*r,t.sideLength*r)}static rotateLeft(t){return new e(-t.x,-t.y,-t.z,t.sideLength)}static rotateRight(t){return new e(-t.x,-t.y,-t.z,t.sideLength)}static direction(t){return e.cubeDirections[t]}static allNeighbors(t){return e.cubeDirections.map(r=>e.add(t,new e(r.x,r.y,r.z,0)))}static diagonalNeighbor(t,r){return e.add(t,e.diagonals[r])}static len(t){return(Math.abs(t.q)+Math.abs(t.r)+Math.abs(t.s))/2}static distance(t,r){return e.len(e.subtract(t,r))}static areaFromSideLength(t){return 3*Math.sqrt(3)/2*Math.pow(t,2)}static sideLengthFromArea(t){return Math.sqrt(t/(3*Math.sqrt(3)/2))}static offsetToCube(t){var e=t.q,r=t.r-(t.q-(1&t.q))/2;return{x:e,y:-e-r,z:r}}static cubeCoordinateToVector2(e,r){var s=r*(1.5*e.x),i=r*(Math.sqrt(3)/2*e.x+Math.sqrt(3)*e.y);return new t.Vector2(s,i)}static cubeToAxial(t,e,r){return{q:t,r:e,s:-t-e}}static axialToCube(t,e){return{x:t,y:e,z:-t-e}}}exports.default=e,e.cubeDirections=[{x:1,y:-1,z:0},{x:1,y:0,z:-1},{x:0,y:1,z:-1},{x:0,y:-1,z:1},{x:-1,y:1,z:0},{x:-1,y:0,z:1}],e.diagonals=[new e(2,-1,-1,0),new e(1,-2,1,0),new e(-1,-1,2,0),new e(-2,1,1,0),new e(-1,2,-1,0),new e(1,1,-2,0)];
},{"@ludic/ludic":"jftt"}],"tTHG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.generateMap=void 0;var e=i(require("../entities/Player")),t=i(require("../entities/Tile")),n=i(require("../entities/Castle")),a=i(require("../components/GamepadComponent")),r=i(require("../components/MechComponent")),l=i(require("./Hex"));function i(e){return e&&e.__esModule?e:{default:e}}const o=function(i,o,s,d){const u=i.pixelsToMeters,f=(Math.ceil(i.height/u),Math.ceil(i.width/u)),p=f/24;let c=[];for(let e=0;e<=16;e++)for(let n=0;n>=-9;n--){let a=l.default.offsetToCube({q:e,r:n}),r=new l.default(a.x,a.y,a.z,p),i="1",d=s.tiles.find(e=>{let t=new l.default(e.pos.x,e.pos.y,e.pos.z,p);return l.default.equal(r,t)});i=d?d.tileType:"1";let u=new t.default(r,i);o.addEntity(u),c.push(u)}s.castles.forEach(e=>{let t=new l.default(e.x,e.y,e.z,p),a=new n.default(t);o.addEntity(a)}),Object.entries(d).forEach(([t,n])=>{let i=s.playerSpawnPoints[parseInt(t)],d=new l.default(i.x,i.y,i.z,p);const u=new e.default(d);u.add(new a.default(parseInt(t))),u.add(new r.default(n)),o.addEntity(u)})};exports.generateMap=o;
},{"../entities/Player":"kbAB","../entities/Tile":"7bCE","../entities/Castle":"0bx0","../components/GamepadComponent":"TbHe","../components/MechComponent":"EAp9","./Hex":"BY5F"}],"26b7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=m(require("@ludic/ludic")),t=m(require("../systems/PlayerMapControlSystem")),s=m(require("../systems/PlayerRenderSystem")),i=m(require("../systems/TileRenderSystem")),n=m(require("../systems/TileActivationSystem")),r=m(require("../systems/CastleRenderSystem")),a=m(require("../systems/CastleDamageSystem")),d=m(require("./BaseLevel")),u=require("../components/mappers"),l=require("../utils/Map");function m(e){return e&&e.__esModule?e:{default:e}}class y extends d.default{constructor(t){super(),this.engine=t,this.tiles=[],this.enemies=[],e.default.debug=!0}init(e){this.initSystems();(0,l.generateMap)(u.CameraComponentMapper.get(this.engine.getSingleton()).camera,this.engine,{tiles:[],castles:[],playerSpawnPoints:[{x:1,y:1,z:-2},{x:3,y:-1,z:2}]},e.playerMap)}initSystems(){this.engine.addSystem(new t.default(this.engine)),this.engine.addSystem(new i.default),this.engine.addSystem(new r.default),this.engine.addSystem(new s.default),this.engine.addSystem(new n.default),this.engine.addSystem(new a.default)}}exports.default=y;
},{"@ludic/ludic":"jftt","../systems/PlayerMapControlSystem":"kL3g","../systems/PlayerRenderSystem":"XPTO","../systems/TileRenderSystem":"h6wx","../systems/TileActivationSystem":"2Va8","../systems/CastleRenderSystem":"R2O5","../systems/CastleDamageSystem":"FwEM","./BaseLevel":"mrzr","../components/mappers":"fAdk","../utils/Map":"tTHG"}],"gBJU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@ludic/ein"),t=r(require("@ludic/ludic")),n=require("../components/mappers");function r(e){return e&&e.__esModule?e:{default:e}}class u extends e.System{update(){const{camera:e}=this.engine.getSingletonComponent(n.CameraComponentMapper);e.update(t.default.canvas.context)}}exports.default=u;
},{"@ludic/ein":"0eJ3","@ludic/ludic":"jftt","../components/mappers":"fAdk"}],"TaYO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=i(require("@ludic/ludic")),t=require("@ludic/ein"),r=s(require("../levels/MapGenerator")),n=s(require("../components/CameraComponent")),a=s(require("../systems/CameraRenderSystem"));function s(e){return e&&e.__esModule?e:{default:e}}function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}class o extends e.Screen{constructor(){super(),this.engine=new t.Engine,this.createCamera(),this.level=new r.default(this.engine)}createCamera(){const t=new e.Camera(e.default.canvas);t.offset=new e.Vector2(0,t.height),t.pixelsToMeters=20,this.engine.addSingletonComponent(new n.default(t)),this.engine.addSystem(new a.default(0))}onAddedToManager(e,t){this.level.init({playerMap:t})}update(t){e.default.canvas.context.save(),e.default.canvas.clear(),this.engine.update(t),e.default.canvas.context.restore()}}exports.default=o;
},{"@ludic/ludic":"jftt","@ludic/ein":"0eJ3","../levels/MapGenerator":"26b7","../components/CameraComponent":"UqyC","../systems/CameraRenderSystem":"gBJU"}],"PZqw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@ludic/ein"),t=o(require("@ludic/ludic")),i=o(require("/src/game/components/GamepadComponent")),s=o(require("/src/game/components/PlayerStateComponent")),a=o(require("/src/game/components/MechComponent")),n=o(require("/src/game/components/PositionComponent")),p=o(require("@ludic/ein/lib/Signal")),r=require("/src/game/components/mappers");function o(e){return e&&e.__esModule?e:{default:e}}class l extends e.System{constructor(){super(),this.players=new Map,this.playerMechMap=new WeakMap,this.playerState=new WeakMap,this.positionMapper=new e.ComponentMapper(n.default),this.gamepadMapper=new e.ComponentMapper(i.default),this.readySignal=new p.default,this.family=e.Family.all([i.default,s.default]).get(),this.mechFamily=e.Family.all([a.default,n.default]).exclude([i.default]).get()}addedToEngine(){this.engine.addEntityListener(this,1,this.family)}entityAdded(e){const t=this.getNextEmptyMech();this.playerMechMap.set(t,e),this.playerState.set(e,{moving:!1,toggling:!1})}entityRemoved(e){}listenForReady(e){this.readySignal.add({receive:e})}getMechs(){return this.engine.getEntitiesFor(this.mechFamily).slice().sort((e,t)=>{const i=this.positionMapper.get(e),s=this.positionMapper.get(t);return i.x-s.x})}getPlayers(){return this.engine.getEntitiesFor(this.family)}update(){this.getMechs().forEach((e,i)=>{const s=this.playerMechMap.get(e),n=this.positionMapper.get(e);if(null!=s){const p=this.positionMapper.get(s);p.x=n.x+1.2,p.y=n.y-3;const o=this.gamepadMapper.get(s),l=t.default.input.gamepad.get(o.index),h=this.playerState.get(s),c=r.MechComponentMapper.get(s),d=l.left.pressed||l.right.pressed;if(!h.moving&&null==c)if(l.right.pressed){h.moving=!0;const t=this.getNextEmptyMech(i);this.playerMechMap.delete(e),this.playerMechMap.set(t,s)}else if(l.left.pressed){h.moving=!0;const t=this.getNextEmptyMech(i,!0);this.playerMechMap.delete(e),this.playerMechMap.set(t,s)}if(!d&&h.moving&&(h.moving=!1),l.cross.buttonUp){h.toggling=!0;const t=r.MechComponentMapper.get(e);null!=c?s.remove(a.default):s.add(new a.default(t.type))}l.start.buttonUp&&this.ready()}})}getNextEmptyMech(e,t=!1){let i=this.getMechs().slice();if(t&&i.reverse(),null!=e){const s=t?i.length-e:e,a=i.splice(0,s);i.push(...a)}return i.find(e=>!this.playerMechMap.has(e))}ready(){this.setProcessing(!1);const e=this.getPlayers().map(e=>[r.GamepadComponentMapper.get(e).index,r.MechComponentMapper.get(e).type]).reduce((e,[t,i])=>({...e,[t]:i}),{});this.readySignal.dispatch(e)}}exports.default=l;
},{"@ludic/ein":"0eJ3","@ludic/ludic":"jftt","/src/game/components/GamepadComponent":"TbHe","/src/game/components/PlayerStateComponent":"ssEh","/src/game/components/MechComponent":"EAp9","/src/game/components/PositionComponent":"6PJe","@ludic/ein/lib/Signal":"wW9q","/src/game/components/mappers":"fAdk"}],"83Sz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@ludic/ein");class t extends e.Component{constructor(e){super(),this.fillStyle=e}}exports.default=t;
},{"@ludic/ein":"0eJ3"}],"VnxR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@ludic/ein"),t=l(require("@ludic/ludic")),r=l(require("../entities/Player")),a=l(require("../components/GamepadComponent")),n=l(require("../components/FillComponent")),s=l(require("../components/PlayerStateComponent")),i=l(require("../utils/Hex"));function l(e){return e&&e.__esModule?e:{default:e}}class u extends e.System{constructor(){super(100),this.players=new Map,this.playerColors={0:"blue",1:"orange",2:"green",3:"purple"},this.time=Date.now()}update(){Object.entries(t.default.input.gamepad.state).forEach(([e,t])=>{if(null!=t.gamepad&&!this.players.has(e)){const r=this.createPlayer(t.gamepad);this.players.set(e,r),this.engine.addEntity(r)}}),this.sleep(500)}createPlayer(e){const t=new r.default(new i.default({q:1,r:1},1));return t.add(new n.default(this.playerColors[e.index])),t.add(new a.default(e.index)),t.add(new s.default),t}}exports.default=u;
},{"@ludic/ein":"0eJ3","@ludic/ludic":"jftt","../entities/Player":"kbAB","../components/GamepadComponent":"TbHe","../components/FillComponent":"83Sz","../components/PlayerStateComponent":"ssEh","../utils/Hex":"BY5F"}],"VQXO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("@ludic/ein"),t=r(require("../../components/GamepadComponent")),a=r(require("@ludic/ludic")),i=r(require("../../components/PositionComponent")),s=r(require("../../components/MechComponent"));function r(e){return e&&e.__esModule?e:{default:e}}class n extends e.System{constructor(a){super(),this.positionMapper=new e.ComponentMapper(i.default),this.gamepadMapper=new e.ComponentMapper(t.default),this.mechMapper=new e.ComponentMapper(s.default),this.family=e.Family.all([t.default]).get(),this.mechFamily=e.Family.all([s.default,i.default]).exclude([t.default]).get(),this.camera=a}getEntities(){return this.engine.getEntitiesFor(this.family)}getMechs(){return this.engine.getEntitiesFor(this.mechFamily)}update(){const e=a.default.canvas.context;e.save(),a.default.canvas.clear(),this.camera.update(e),this.camera.drawAxes(e),this.getMechs().forEach(t=>{e.save();const a=this.positionMapper.get(t),i=this.mechMapper.get(t);e.fillStyle=i.type,e.fillRect(a.x,a.y,3,3),e.restore()}),this.getEntities().forEach(t=>{e.save();const a=this.positionMapper.get(t),i=this.gamepadMapper.get(t),s=this.mechMapper.get(t);e.fillStyle=null!=s?s.type:"black",e.scale(1,-1),e.font="1px sans-serif",e.fillText(""+(i.index+1),a.x,a.y),e.restore()}),e.restore()}}exports.default=n;
},{"@ludic/ein":"0eJ3","../../components/GamepadComponent":"TbHe","@ludic/ludic":"jftt","../../components/PositionComponent":"6PJe","../../components/MechComponent":"EAp9"}],"pq7o":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=c(require("@ludic/ludic")),t=require("@ludic/ein"),n=d(require("../systems/characterSelect/CharacterSelectSystem")),i=d(require("../systems/PlayerCreate")),r=d(require("../systems/characterSelect/CharacterSelectRenderer")),a=d(require("../components/PositionComponent")),s=d(require("../components/MechComponent"));function d(e){return e&&e.__esModule?e:{default:e}}function c(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};i.get||i.set?Object.defineProperty(t,n,i):t[n]=e[n]}return t.default=e,t}class o extends e.Screen{constructor(){super(),this.selectSystem=new n.default,this.engine=new t.Engine,this.camera=new e.Camera(e.default.canvas),this.camera.centerWorldToCamera()}onAddedToManager(){this.engine.addSystem(new i.default),this.engine.addSystem(this.selectSystem),this.selectSystem.listenForReady(this.onSelectReady.bind(this)),this.engine.addSystem(new r.default(this.camera)),this.initMechClasses()}onSelectReady(e,t){this.finish(t)}initMechClasses(){const e=this.engine.createEntity();e.add(new a.default(-10,2)),e.add(new s.default("red")),this.engine.addEntity(e);const t=this.engine.createEntity();t.add(new a.default(-4,2)),t.add(new s.default("green")),this.engine.addEntity(t);const n=this.engine.createEntity();n.add(new a.default(2,2)),n.add(new s.default("blue")),this.engine.addEntity(n);const i=this.engine.createEntity();i.add(new a.default(8,2)),i.add(new s.default("orange")),this.engine.addEntity(i)}update(e){this.engine.update(e)}}exports.default=o;
},{"@ludic/ludic":"jftt","@ludic/ein":"0eJ3","../systems/characterSelect/CharacterSelectSystem":"PZqw","../systems/PlayerCreate":"VnxR","../systems/characterSelect/CharacterSelectRenderer":"VQXO","../components/PositionComponent":"6PJe","../components/MechComponent":"EAp9"}],"9rwB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=a(require("@ludic/ludic")),r=n(require("./screens/MapGeneratorScreen")),t=n(require("./screens/CharacterSelectScreen"));function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}class c extends e.default{constructor(r){super(r),e.default.input.addController(new e.GamepadController),this.screenManager=new e.ScreenManager,this.screenManager.addScreenEventListener(this),this.screenManager.addScreen(new t.default)}onScreenFinished(e,n,a){e instanceof t.default&&this.screenManager.addScreen(new r.default,!0)}onScreenAdded(e,r,t){}onScreensRemoved(e,r){}onWarnPopScreen(e,r){}update(e,r){super.update(e,r),this.screenManager.update(r)}}exports.default=c;
},{"@ludic/ludic":"jftt","./screens/MapGeneratorScreen":"TaYO","./screens/CharacterSelectScreen":"pq7o"}],"9B6d":[function(require,module,exports) {
"use strict";var e=r(require("/src/game/game"));function r(e){return e&&e.__esModule?e:{default:e}}new e.default({el:"#game"}).start();
},{"/src/game/game":"9rwB"}]},{},["9B6d"], null)
//# sourceMappingURL=/src.d9d9148c.js.map